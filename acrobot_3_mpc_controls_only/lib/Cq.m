function CqOut = Cq(theta,Dtheta, params)

theta11 = theta(1);
theta12 = theta(2);
theta13 = theta(3);

Dtheta11 = Dtheta(1);
Dtheta12 = Dtheta(2);
Dtheta13 = Dtheta(3);

mBody = params.m3;
mLink = params.m1;
lLink1 = params.l1;
lLink2 = params.l3;
rBody = params.l2;
%%
CqOut = [(1/2).*((-2).*(Dtheta11+Dtheta12).*Dtheta13.*mBody.*rBody.*(lLink2.* ...
  sin(theta13)+lLink1.*sin(theta12+theta13))+(-1).*Dtheta13.^2.*mBody.* ...
  rBody.*(lLink2.*sin(theta13)+lLink1.*sin(theta12+theta13))+(-1).* ...
  Dtheta12.*(2.*Dtheta11+Dtheta12).*lLink1.*(lLink2.*(2.*mBody+mLink).* ...
  sin(theta12)+mBody.*rBody.*sin(theta12+theta13))),(1/2).*((-2).*( ...
  Dtheta11+Dtheta12).*Dtheta13.*lLink2.*mBody.*rBody.*sin(theta13)+(-1).* ...
  Dtheta13.^2.*lLink2.*mBody.*rBody.*sin(theta13)+Dtheta11.^2.*lLink1.*( ...
  lLink2.*(2.*mBody+mLink).*sin(theta12)+mBody.*rBody.*sin(theta12+ ...
  theta13))),(1/2).*mBody.*rBody.*(Dtheta11.^2.*lLink1.*cos(theta13).*sin( ...
  theta12)+(Dtheta11+Dtheta12).^2.*lLink2.*sin(theta13)+Dtheta11.^2.* ...
  lLink1.*cos(theta12).*sin(theta13))];
end