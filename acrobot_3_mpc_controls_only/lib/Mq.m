function MqOut = Mq(theta,params)

theta11 = theta(1);
theta12 = theta(2);
theta13 = theta(3);

mBody = params.m3;
mLink = params.m1;
lLink1 = params.l1;
lLink2 = params.l3;
rBody = params.l2;
%%
MqOut = [(1/4).*(lLink2.^2.*(4.*mBody+mLink)+lLink1.^2.*(4.*mBody+13.*mLink)+5.* ...
  mBody.*rBody.^2+4.*lLink1.*lLink2.*(2.*mBody+mLink).*cos(theta12)+4.* ...
  mBody.*rBody.*(lLink2.*cos(theta13)+lLink1.*cos(theta12+theta13))),(1/4) ...
  .*(4.*lLink1.^2.*mLink+lLink2.^2.*(4.*mBody+mLink)+5.*mBody.*rBody.^2+ ...
  2.*lLink1.*lLink2.*(2.*mBody+mLink).*cos(theta12)+4.*lLink2.*mBody.* ...
  rBody.*cos(theta13)+2.*lLink1.*mBody.*rBody.*cos(theta12+theta13)),(1/4) ...
  .*mBody.*rBody.*(5.*rBody+2.*lLink2.*cos(theta13)+2.*lLink1.*cos( ...
  theta12+theta13));(1/4).*(4.*lLink1.^2.*mLink+lLink2.^2.*(4.*mBody+ ...
  mLink)+5.*mBody.*rBody.^2+2.*lLink1.*lLink2.*(2.*mBody+mLink).*cos( ...
  theta12)+4.*lLink2.*mBody.*rBody.*cos(theta13)+2.*lLink1.*mBody.*rBody.* ...
  cos(theta12+theta13)),(1/4).*(4.*lLink1.^2.*mLink+lLink2.^2.*(4.*mBody+ ...
  mLink)+5.*mBody.*rBody.^2+4.*lLink2.*mBody.*rBody.*cos(theta13)),(1/4).* ...
  mBody.*rBody.*(5.*rBody+2.*lLink2.*cos(theta13));(1/4).*mBody.*rBody.*( ...
  5.*rBody+2.*lLink2.*cos(theta13)+2.*lLink1.*cos(theta12+theta13)),(1/4) ...
  .*mBody.*rBody.*(5.*rBody+2.*lLink2.*cos(theta13)),(5/4).*mBody.* ...
  rBody.^2];
end